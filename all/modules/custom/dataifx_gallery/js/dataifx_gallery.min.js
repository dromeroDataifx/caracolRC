(function(a){a.fn.build=function(b){var c={height:150,duration:100,auto:true,autoTime:6000};var b=a.extend(c,b);return this.each(function(){var m=0;var y=0;var d=a(this);var w={};a.get(b.configUrl,b.params,function(B){if(B){w=B;i()}});function i(){u(w);t(w);s(w)}function u(F){var H=d.find(".dataifx_gallery-main-image-content");H.find(".dataifx_gallery-main-image-picture").append('<img src="'+F.images[0].image_src+'" title="'+F.images[0].title+'" data-image-index="0"/>');H.find(".dataifx_gallery-main-image-title .field-content").html(F.images[0].title);H.find(".dataifx_gallery-main-image-description .field-content").html(F.images[0].caption);var E=F.images.slice(m,F.images.length-1);var B=H.parent().find(".dataifx_gallery-main-chached");for(var D in E){B.append('<img class="dataifx_gallery-cached-image" src="'+E[D].image_src+'" title="'+E[D].title+'" data-image-index="'+D+'"/>')}var C=B.parent().find("img");var G=0;C.load(function(){G++;if(G>=C.length){d.trigger(a.Event("mainImagesLoaded"))}})}function t(E){var D=d.find(".dataifx_gallery-thumb-images-content");for(var C in E.images){D.append('<img src="'+E.images[C].thumb_src+'" title="'+E.images[C].title+'" data-thumbnail-index="'+C+'"/>')}var F=D.find("img");var B=0;F.load(function(){B++;if(B>=F.length){d.trigger(a.Event("thumbnailsLoaded"))}})}function s(){var H=false;var B=false;d.bind({mainImagesLoaded:function(){B=true;k();if(H&&B){d.trigger(a.Event("buildFinished"))}},thumbnailsLoaded:function(){H=true;r();if(H&&B){d.trigger(a.Event("buildFinished"))}},buildFinished:l});var C=d.find(".dataifx_gallery-main-area");var K=C.find(".dataifx_gallery-main-control-previous");var J=C.find(".dataifx_gallery-main-control-next");var E=C.find(".dataifx_gallery-main-image-download");K.bind({click:h});J.bind({click:z});E.bind({click:f});var F=d.find(".dataifx_gallery-thumb-area");var G=F.find(".dataifx_gallery-thumb-control-previous");var I=F.find(".dataifx_gallery-thumb-control-next");G.bind({click:n});I.bind({click:g});var D=d.find(".dataifx_gallery-thumb-images-content img");D.bind({click:e})}function k(B){var E=d.find(".dataifx_gallery-main-image img");var G=d.find(".dataifx_gallery-main-control-previous");var J=d.find(".dataifx_gallery-main-control-next");var I=0;var H=0;E.each(function(L,M){I=I<a(this).outerWidth(true)?a(this).outerWidth(true):I;H=H<a(this).outerHeight(true)?a(this).outerHeight(true):H});d.find(".dataifx_gallery-main-image-content").css({height:H,width:I});d.find(".dataifx_gallery-main-area").css({width:d.find(".dataifx_gallery-main-image").outerWidth(true)+G.outerWidth(true)+J.outerWidth(true),height:d.find(".dataifx_gallery-main-image").outerHeight(true)});d.find(".dataifx_gallery-main-image-content .dataifx_gallery-main-image-description .field-content").css({paddingRight:d.find(".dataifx_gallery-main-image-download").outerWidth()});var F=d.find(".dataifx_gallery-thumb-area");var K=F.find(".dataifx_gallery-thumb-images");var C=F.find(".dataifx_gallery-thumb-control-previous");var D=F.find(".dataifx_gallery-thumb-control-next");K.css({width:d.find(".dataifx_gallery-main-area").outerWidth()-(C.outerWidth(true)+D.outerWidth(true)+20)})}function r(){var C=d.find(".dataifx_gallery-thumb-images-content");var B=C.find("img");var H=d.find(".dataifx_gallery-thumb-area");var J=H.find(".dataifx_gallery-thumb-images");var E=0;var G=0;B.each(function(L,M){E+=a(this).outerWidth(true);G=G<a(this).outerHeight(true)?a(this).outerHeight(true):G});C.css({width:E!==0?E:"auto"});J.css({height:G});H.css({height:G});var I=0;var F=0;var D=J.outerWidth();var K=0;B.each(function(M,N){F+=a(this).outerWidth(true);if(F>D||M>=B.length-1){var L=null;if(M>=B.length-1){L=B.filter(":gt("+(K-1)+")")}else{L=B.filter(":lt("+(M)+")");if(K>0){L=L.filter(":gt("+(K-1)+")")}}L.wrapAll('<div class="thumbnail-page thumbnail-page-'+I+'" data-thumbnail-page="'+I+'">');K=M;F=0;I++}});A(0)}function l(B){var C=d.find(".dataifx_gallery-thumb-area");d.parent().css({width:d.find(".dataifx_gallery-main-area").outerWidth(true),height:d.find(".dataifx_gallery-main-area").outerHeight(true)+C.outerHeight(true)})}function e(B){q(a(B.target).data("thumbnail-index"))}function n(B){j()}function g(B){x()}function h(B){p()}function z(B){v()}function f(B){window.open(w.images[m].image_link_src,"_blank")}function q(C){var G=d.find(".dataifx_gallery-thumb-images-content img");var F=G.length-1;if(C>F){C=0}if(C<0){C=F}var D=G.filter("[data-thumbnail-index="+C+"]");G.removeClass("dataifx-gallery-thumbnail-selected");D.addClass("dataifx-gallery-thumbnail-selected");var E=d.find(".dataifx_gallery-main-image-content");var B=E.find(".dataifx_gallery-main-image-picture img");B.attr({src:w.images[C].image_src,title:w.images[C].title,"data-image-index":C});E.find(".dataifx_gallery-main-image-title .field-content").html(w.images[C].title);E.find(".dataifx_gallery-main-image-description .field-content").html(w.images[C].caption);m=C}function A(D){var C=d.find(".thumbnail-page");var E=C.length-1;if(D>E){D=0}if(D<0){D=E}var B=C.filter("[data-thumbnail-page="+D+"]");C.removeClass("dataifx-gallery-thumbnail-page-selected").hide();B.addClass("dataifx-gallery-thumbnail-page-selected").show();y=D}function p(B){q(m-1)}function v(B){q(m+1)}function j(B){A(y-1)}function x(B){A(y+1)}function o(){}})}})(jQuery);